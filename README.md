# dicexp-deno

> In memory of ADNMB.

使用 deno 编写的 <ruby>Dicexp<rt>骰子表达式</rt><ruby>&#160;执行器。

WIP / DO NOT USE.

## 骰子表达式 Dicexp

简单的介绍文档见[这里](./docs/Dicexp.md)。

## 预备工作

- 安装 [just](https://just.systems)，用于执行命令。
- 安装 [Deno](https://deno.land)，用于其他一切。

## REPL

本项目仍处于早期开发阶段，暂不在文档中提供作为库使用的方式。如想尝试，可以在命令行执行以下命令进入
REPL：

```shell
just repl
```

## TODO

- [ ] 写文档。
- [ ] 让运算符支持列表与基本类型之间的运算，例如：
  - `10#d6 * 2` == `map(10#d6, &*/2)`
  - `[1, 2, 3] > 2` == `[false, false, true]`？
- [ ] 更精细的执行限制。
  - 作为 MVP，目前只在执行的外层限制了执行时间与结果字符串字数。
  - 其他可以作为限制的方面：
    - 单一列表元素数
    - 值的数量
    - 作用域层数
    - 气（每个执行操作都消耗一定量的气）
  - 另外，需要注意限制比较贵的运算，尤其是如果以后引入了
    bigint，像是指数运算不会止于 `Infinity`。
- [ ] 更好的错误信息。
- [ ] 展开步骤尚未完成（目前的实现只是为了体现步骤的概念。）：
  - 基本上目前所有的错误都会导致层数更深的步骤丢失。
  - 展开的步骤时，部分情况下可以省略掉括号。（比如相同的运算符从左向右执行。）这需要更复杂的记录步骤的实现。
- [ ] 列表的惰性求值。
- [ ] Trampoline。
